<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>YouTube 채널 영상 정렬기</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input, button { padding: 8px; margin: 5px 0; width: 100%; }
    ul { list-style: none; padding: 0; }
    li { margin: 10px 0; }
  </style>
</head>
<body>
  <h2>YouTube 채널 영상 (오래된 순)</h2>
  <input type="text" id="channelId" placeholder="채널 ID 입력 (예: UC_x5XG1OV2P6uZZ5FSM9Ttw)">
  <input type="text" id="apiKey" placeholder="YouTube API 키 입력">
  <button onclick="fetchVideos()">영상 불러오기</button>
  <ul id="videoList"></ul>

  <script>
    async function fetchVideos() {
      const channelId = document.getElementById('channelId').value;
      const apiKey = document.getElementById('apiKey').value;
      const videoList = document.getElementById('videoList');
      videoList.innerHTML = '<li>로딩 중...</li>';

      try {
        const uploadsPlaylist = await fetch(`https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=${channelId}&key=${apiKey}`)
          .then(res => res.json())
          .then(data => data.items[0].contentDetails.relatedPlaylists.uploads);

        let videos = [];
        let nextPageToken = '';
        do {
          const url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=${uploadsPlaylist}&maxResults=50&pageToken=${nextPageToken}&key=${apiKey}`;
          const res = await fetch(url).then(r => r.json());
          videos = videos.concat(res.items);
          nextPageToken = res.nextPageToken;
        } while (nextPageToken);

        videoList.innerHTML = '';
        videos.reverse().forEach(item => {
          const title = item.snippet.title;
          const videoId = item.snippet.resourceId.videoId;
          const url = `https://www.youtube.com/watch?v=${videoId}`;
          const li = document.createElement('li');
          li.innerHTML = `<a href="${url}" target="_blank">${title}</a>`;
          videoList.appendChild(li);
        });

      } catch (err) {
        videoList.innerHTML = `<li>에러 발생: ${err.message}</li>`;
      }
    }
  </script>
</body>
</html>
